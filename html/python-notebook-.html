
<!DOCTYPE html>
<html lang="en">
<head>
      <meta charset="UTF-8">
      <meta content="width=device-width, initial-scale=1" name="viewport" />

      <link rel="stylesheet" href="assets/css/bootstrap.min.css">
      <link rel="stylesheet" href="assets/css/style-blog.css" />
      <link rel="stylesheet" href="assets/css/codehilite.css" />
      <link rel="stylesheet" href="assets/css/monokai.theme.css" />

    <style>
        h2{
            font-size: 1.6em;
        }
        h3{
            font-size: 1.4em;
        }
        h2,h3{
            color : #17a2b8;
            font-weight: bolder;
        }
        img {
            max-width: 90%;
        }
        #night-mode{
             position: fixed; top:10px; right:20px;
             z-index: 100;
        }

    </style>
    <script src="https://kit.fontawesome.com/7f0b5f1f38.js" crossorigin="anonymous"></script>
    <title>Python - Notebook.</title>
</head>
<body>
    <a href="#" id="night-mode"><i class="fas fa-moon"></i></a>
    <div class="main">
          <nav class="left-nav">
            <div class="nav-left-content">
              <div class="nav-top-left">
                <h4>
                  <a href="#" class="icon icon-home">Python - Notebook.</a>
                </h4>
              </div>
              <div class="nav-second-left">
                 <ul><li class="toctree-l1" id="nav_1"><a class="reference internal" href="#introduction-install">Introduction & Install</a></li><li class="toctree-l1" id="nav_2"><a class="reference internal" href="#creation-projet-java">Création Projet Java</a></li><li class="toctree-l1" id="nav_3"><a class="reference internal" href="#couche-dao">Couche Dao</a></li><li class="toctree-l1" id="nav_4"><a class="reference internal" href="#tests">Tests</a></li></ul>
              </div>
            </div>
          </nav>
          <section class="main-section">
              <nav class="main-section-top" role="navigation" aria-label="top navigation">
                <a href="#">Python - Notebook.</a>
                <button class="navbar-toggler" style="float:right;margin-right:20px;" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon" style="color:white"> <i data-toggle="wy-nav-top" class="fa fa-bars"></i></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                    <div class="navbar-nav-mob">
                         <ul><li class="toctree-l1" id="nav_1"><a class="reference internal" href="#introduction-install">Introduction & Install</a></li><li class="toctree-l1" id="nav_2"><a class="reference internal" href="#creation-projet-java">Création Projet Java</a></li><li class="toctree-l1" id="nav_3"><a class="reference internal" href="#couche-dao">Couche Dao</a></li><li class="toctree-l1" id="nav_4"><a class="reference internal" href="#tests">Tests</a></li></ul>
                    </div>
                 </div>
              </nav>
              <div class="main-section-content">
                  <div class="rst-content">
                    <div role="navigation" aria-label="breadcrumbs navigation">
                      <ul class="wy-breadcrumbs">
                        <li><a href="index.html">Index</a> <i class="fas fa-angle-double-right"></i></li>
                        <li>Python - Notebook.</li>
                        <li class="wy-breadcrumbs-aside">
                          <a href="https://mchou69.github.io"><i class="fab fa-github-square"></i> Edit on GitHub</a>
                        </li>
                      </ul>
                      <hr>
                    </div>
                  </div>

                  <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
                      <div itemprop="articleBody">
                          <section id="introduction-install" class="article active"><h2>Introduction &amp; Install</h2>


<h3>Hibernate</h3>


<p>Hibernate est un <strong>ORM</strong> (Object Relational Mapping) open source, qui facilite le développement de la couche persistance d'une application. 
Hibernate permet de représenter une base de données en objets Java et vice versa.</p>


<p>Hibernate est une solution très populaire grâce notamment à ses bonnes performances et au nombre important de bases de données supportées : DB2, Oracle, MySQL, PostgreSQL, Sybase, SQL Server, Sap DB, Interbase, ...</p>


<h3>Projet Java Exemple</h3>


<p>On va créer une application Java avec intégration de Hibernate (version 5.2.x) pour se connecter à une base de données <strong>catalogue</strong> sous MySQL. </p>


<h3>script création de la base de données 'Catalogue' :</h3>


<div class="codehilite"><pre><span></span>    <span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="k">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="ss">`catalogue`</span>
    <span class="k">USE</span> <span class="ss">`catalogue`</span><span class="p">;</span>

    <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="k">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="ss">`categories`</span> <span class="p">(</span>
      <span class="ss">`id`</span> <span class="kt">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span> <span class="kp">AUTO_INCREMENT</span><span class="p">,</span>
      <span class="ss">`nom`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
      <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="ss">`id`</span><span class="p">)</span>
    <span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="kp">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">4</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">latin1</span><span class="p">;</span>

    <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="k">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="ss">`produits`</span> <span class="p">(</span>
      <span class="ss">`id`</span> <span class="kt">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span> <span class="kp">AUTO_INCREMENT</span><span class="p">,</span>
      <span class="ss">`nom`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
      <span class="ss">`description`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
      <span class="ss">`photo`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
      <span class="ss">`prix`</span> <span class="kt">float</span> <span class="k">DEFAULT</span> <span class="s1">'0'</span><span class="p">,</span>
      <span class="ss">`id_categorie`</span> <span class="kt">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
      <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="ss">`id`</span><span class="p">),</span>
      <span class="k">KEY</span> <span class="ss">`index_fk`</span> <span class="p">(</span><span class="ss">`id_categorie`</span><span class="p">),</span>
      <span class="k">CONSTRAINT</span> <span class="ss">`fk_categorie`</span> <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="ss">`id_categorie`</span><span class="p">)</span> 
            <span class="k">REFERENCES</span> <span class="ss">`categories`</span> <span class="p">(</span><span class="ss">`id`</span><span class="p">)</span> <span class="k">ON</span> <span class="k">UPDATE</span> <span class="k">CASCADE</span>
    <span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="kp">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">9</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">latin1</span><span class="p">;</span>

    <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="k">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="ss">`users`</span> <span class="p">(</span>
      <span class="ss">`id`</span> <span class="kt">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span> <span class="kp">AUTO_INCREMENT</span><span class="p">,</span>
      <span class="ss">`prenom`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
      <span class="ss">`nom`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
      <span class="ss">`login`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
      <span class="ss">`password`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
      <span class="ss">`photo`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
      <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="ss">`id`</span><span class="p">)</span>
    <span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="kp">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">4</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">latin1</span><span class="p">;</span>
</pre></div>

</section><section id="creation-projet-java" class="article hidden"><h2>Création Projet Java</h2>


<h3>Création Projet Java 'CatalogueHibernate5':</h3>


<p><img alt="new-project" src="images/eclipse_create_project_0.png"/></p>


<p><img alt="new-project" src="images/eclipse_create_project_1.png"/></p>


<h3>Maven : gérer les dépendances</h3>


<p>Ajouter gestion Maven au projet (menu contextuel) :</p>


<p><img alt="new-project-add-maven" src="images/eclipse_create_project_2.png"/></p>


<p>Dans fichier <strong>pom.xml</strong> généré, ajouter les dépendances pour <strong>MySql</strong> et <strong>Hibernate</strong> :</p>


<p><img alt="new-project-maven-dependancies" src="images/eclipse_create_project_3.png"/></p>


<p>Maven Dependencies après sauvegarde du fichier <strong>pom.xml</strong> :</p>


<p><img alt="new-project-maven-dependancies" src="images/eclipse_create_project_4.png"/></p>


<h3>Hibernate : Configuration</h3>


<p>Utiliser <strong>Hibernate Tools</strong> pour créer le fichier de configuration d'Hibernate :</p>


<p>se positionner sur rép. <strong>src</strong> du projet : file&gt;new&gt;other..</p>


<p><img alt="new-project-hibernate-config" src="images/eclipse_create_project_5.png"/></p>


<p><img alt="new-project-hibernate-config" src="images/eclipse_create_project_6.png"/>
<img alt="new-project-hibernate-config" src="images/eclipse_create_project_7.png"/>
<img alt="new-project-hibernate-config" src="images/eclipse_create_project_8.png"/>
<img alt="new-project-hibernate-config" src="images/eclipse_create_project_9.png"/></p>


<h3>Hibernate Tools : générer les classes 'Entity'</h3>


<p>Utiliser <strong>Hibernate Tools</strong> pour générer les classes 'Entity' mappées sur les tables de la base de données 'Catalogue' :</p>


<p><img alt="new-project-hibernate-entities" src="images/eclipse_create_project_10.png"/>
<img alt="new-project-hibernate-entities" src="images/eclipse_create_project_11.png"/>
<img alt="new-project-hibernate-entities" src="images/eclipse_create_project_12.png"/>
<img alt="new-project-hibernate-entities" src="images/eclipse_create_project_13.png"/></p>


<p>apply + run :</p>


<p><img alt="new-project-hibernate-entities" src="images/eclipse_create_project_14.png"/></p>


<h3>Hibernate Config. : ajouter classes mappées</h3>


<p>dans <strong>hibernate.cfg.xml</strong> ajouter le mapping des classes entity :</p>


<p><img alt="new-project-hibernate-entities" src="images/eclipse_create_project_15.png"/></p>


<h3>HibernateUtil : Création SessionFactory et Session</h3>


<p>Ajouter la classe <strong>HibernateUtil</strong>qui permettra de créer une <code>SessionFactory</code> et un objet <code>Session</code> Hibernate.</p>


<blockquote>
<p>L'objet Session est utilisé pour établir une connexion physique avec une 
base de données. Il est léger et conçu pour être instancié chaque fois
qu'une interaction est requise avec la base de données. Les objets ersistants sont enregistrés et récupérés via un objet Session.</p>
</blockquote>


<div class="codehilite"><pre><span></span>    <span class="n">package</span> <span class="n">mc</span><span class="o">.</span><span class="n">tuto</span><span class="o">.</span><span class="n">hibernate</span><span class="p">;</span>

    <span class="kn">import</span> <span class="nn">org.hibernate.SessionFactory</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">org.hibernate.boot.Metadata</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">org.hibernate.boot.MetadataSources</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">org.hibernate.boot.registry.StandardServiceRegistry</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">org.hibernate.boot.registry.StandardServiceRegistryBuilder</span><span class="p">;</span>

    <span class="n">public</span> <span class="k">class</span> <span class="nc">HibernateUtil</span> <span class="p">{</span>
        <span class="n">private</span> <span class="n">static</span> <span class="n">StandardServiceRegistry</span> <span class="n">registry</span><span class="p">;</span>
        <span class="n">private</span> <span class="n">static</span> <span class="n">SessionFactory</span> <span class="n">sessionFactory</span><span class="p">;</span>
        <span class="n">public</span> <span class="n">static</span> <span class="n">SessionFactory</span> <span class="n">getSessionFactory</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sessionFactory</span> <span class="o">==</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">try</span> <span class="p">{</span>
                    <span class="o">//</span> <span class="n">Create</span> <span class="n">registry</span>
                    <span class="n">registry</span> <span class="o">=</span> <span class="n">new</span> <span class="n">StandardServiceRegistryBuilder</span><span class="p">()</span><span class="o">.</span>
                        <span class="n">configure</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">();</span>
                    <span class="o">//</span> <span class="n">Create</span> <span class="n">MetadataSources</span>
                    <span class="n">MetadataSources</span> <span class="n">sources</span> <span class="o">=</span> <span class="n">new</span> <span class="n">MetadataSources</span><span class="p">(</span><span class="n">registry</span><span class="p">);</span>
                    <span class="o">//</span> <span class="n">Create</span> <span class="n">Metadata</span>
                    <span class="n">Metadata</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">sources</span><span class="o">.</span><span class="n">getMetadataBuilder</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">();</span>
                    <span class="o">//</span> <span class="n">Create</span> <span class="n">SessionFactory</span>
                    <span class="n">sessionFactory</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">getSessionFactoryBuilder</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">();</span>
                <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="ne">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">e</span><span class="o">.</span><span class="n">printStackTrace</span><span class="p">();</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">registry</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
                        <span class="n">StandardServiceRegistryBuilder</span><span class="o">.</span><span class="n">destroy</span><span class="p">(</span><span class="n">registry</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">sessionFactory</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">shutdown</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">registry</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">StandardServiceRegistryBuilder</span><span class="o">.</span><span class="n">destroy</span><span class="p">(</span><span class="n">registry</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>


<h3>Création SessionFactory : Test Unitaire (JUnit)</h3>


<p>Créer un test unitaire avec JUnit :</p>


<div class="codehilite"><pre><span></span>    <span class="n">package</span> <span class="n">mc</span><span class="o">.</span><span class="n">tuto</span><span class="o">.</span><span class="n">junit</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">org.hibernate.Session</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">org.hibernate.SessionFactory</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">org.junit.Assert</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">mc.tuto.hibernate.HibernateUtil</span><span class="p">;</span>

    <span class="k">class</span> <span class="nc">SessionHibernateTests</span> <span class="p">{</span>

        <span class="nd">@Test</span>
        <span class="n">void</span> <span class="n">test1</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">SessionFactory</span> <span class="n">sessionFactory</span> <span class="o">=</span> <span class="n">HibernateUtil</span><span class="o">.</span><span class="n">getSessionFactory</span><span class="p">();</span>
            <span class="n">Assert</span><span class="o">.</span><span class="n">assertNotNull</span><span class="p">(</span><span class="n">sessionFactory</span><span class="p">);</span>

            <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">"SessionFactory : "</span><span class="o">+</span><span class="n">sessionFactory</span><span class="p">);</span>

            <span class="n">Session</span> <span class="n">session</span> <span class="o">=</span> <span class="n">sessionFactory</span><span class="o">.</span><span class="n">openSession</span><span class="p">();</span>
            <span class="n">Assert</span><span class="o">.</span><span class="n">assertNotNull</span><span class="p">(</span><span class="n">session</span><span class="p">);</span>

            <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">"Session : "</span><span class="o">+</span><span class="n">session</span><span class="p">);</span>

            <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>        
        <span class="p">}</span>

    <span class="p">}</span>
</pre></div>


<p>Résultat test :</p>


<p><img alt="new-project-hibernate-junit" src="images/eclipse_create_project_16.png"/></p>

</section><section id="couche-dao" class="article hidden"><h2>Couche Dao</h2>


<h3>Mise en place du pattern Dao</h3>


<h4>Création interface générique IDao<t></t></h4>


<div class="codehilite"><pre><span></span>    <span class="n">package</span> <span class="n">mc</span><span class="o">.</span><span class="n">tuto</span><span class="o">.</span><span class="n">dao</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

    <span class="n">public</span> <span class="n">interface</span> <span class="n">IDao</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">getAll</span><span class="p">();</span>
        <span class="n">T</span> <span class="n">getById</span><span class="p">(</span><span class="nb">int</span> <span class="nb">id</span><span class="p">);</span>

        <span class="n">T</span> <span class="n">add</span><span class="p">(</span><span class="n">T</span> <span class="n">item</span><span class="p">);</span>
        <span class="n">T</span> <span class="n">update</span><span class="p">(</span><span class="n">T</span> <span class="n">item</span><span class="p">);</span>
        <span class="n">boolean</span> <span class="n">delete</span><span class="p">(</span><span class="n">T</span> <span class="n">item</span><span class="p">);</span>
    <span class="p">}</span>
</pre></div>


<h4>Implementer interface : calsses Dao (ProduitsDao, CategoriesDao,..)</h4>


<p>classe <strong>ProduitsDao</strong> :</p>


<div class="codehilite"><pre><span></span>    <span class="n">package</span> <span class="n">mc</span><span class="o">.</span><span class="n">tuto</span><span class="o">.</span><span class="n">dao</span><span class="p">;</span>

    <span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">javax.persistence.criteria.CriteriaQuery</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">org.hibernate.Session</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">org.hibernate.SessionFactory</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">mc.tuto.entities.Produits</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">mc.tuto.hibernate.HibernateUtil</span><span class="p">;</span>

    <span class="n">public</span> <span class="k">class</span> <span class="nc">ProduitsDao</span> <span class="n">implements</span> <span class="n">IDao</span><span class="o">&lt;</span><span class="n">Produits</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="n">Session</span> <span class="n">session</span><span class="p">;</span>
        <span class="n">public</span> <span class="n">ProduitsDao</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">SessionFactory</span> <span class="n">sessionfactory</span> <span class="o">=</span> <span class="n">HibernateUtil</span><span class="o">.</span><span class="n">getSessionFactory</span><span class="p">();</span>
            <span class="n">session</span> <span class="o">=</span> <span class="n">sessionfactory</span><span class="o">.</span><span class="n">openSession</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="nd">@Override</span>
        <span class="n">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Produits</span><span class="o">&gt;</span> <span class="n">getAll</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">CriteriaQuery</span><span class="o">&lt;</span><span class="n">Produits</span><span class="o">&gt;</span> <span class="n">criteria</span> <span class="o">=</span> 
                    <span class="n">session</span><span class="o">.</span><span class="n">getCriteriaBuilder</span><span class="p">()</span><span class="o">.</span><span class="n">createQuery</span><span class="p">(</span><span class="n">Produits</span><span class="o">.</span><span class="n">class</span><span class="p">);</span>
            <span class="n">criteria</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="n">Produits</span><span class="o">.</span><span class="n">class</span><span class="p">);</span>

            <span class="n">List</span><span class="o">&lt;</span><span class="n">Produits</span><span class="o">&gt;</span> <span class="n">produits</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">createQuery</span><span class="p">(</span><span class="n">criteria</span><span class="p">)</span><span class="o">.</span><span class="n">getResultList</span><span class="p">();</span>
            <span class="k">return</span> <span class="n">produits</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nd">@Override</span>
        <span class="n">public</span> <span class="n">Produits</span> <span class="n">getById</span><span class="p">(</span><span class="nb">int</span> <span class="nb">id</span><span class="p">)</span> <span class="p">{</span>   
            <span class="k">return</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Produits</span><span class="o">.</span><span class="n">class</span><span class="p">,</span> <span class="nb">id</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nd">@Override</span>
        <span class="n">public</span> <span class="n">Produits</span> <span class="n">add</span><span class="p">(</span><span class="n">Produits</span> <span class="n">item</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Transaction</span> <span class="n">transaction</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">beginTransaction</span><span class="p">();</span>
            <span class="n">session</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
            <span class="n">transaction</span><span class="o">.</span><span class="n">commit</span><span class="p">();</span>
            <span class="k">return</span> <span class="n">item</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nd">@Override</span>
        <span class="n">public</span> <span class="n">Produits</span> <span class="n">update</span><span class="p">(</span><span class="n">Produits</span> <span class="n">item</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Transaction</span> <span class="n">transaction</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">beginTransaction</span><span class="p">();</span>
            <span class="n">session</span><span class="o">.</span><span class="n">saveOrUpdate</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
            <span class="n">transaction</span><span class="o">.</span><span class="n">commit</span><span class="p">();</span>
            <span class="k">return</span> <span class="n">item</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nd">@Override</span>
        <span class="n">public</span> <span class="n">boolean</span> <span class="n">delete</span><span class="p">(</span><span class="n">Produits</span> <span class="n">item</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="n">Transaction</span> <span class="n">transaction</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">beginTransaction</span><span class="p">();</span>
                <span class="n">session</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
                <span class="n">transaction</span><span class="o">.</span><span class="n">commit</span><span class="p">();</span>
            <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="ne">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">false</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">true</span><span class="p">;</span>        
        <span class="p">}</span>            
    <span class="p">}</span>
</pre></div>

</section><section id="tests" class="article hidden"><h2>Tests</h2>


<div class="codehilite"><pre><span></span>    <span class="n">package</span> <span class="n">mc</span><span class="o">.</span><span class="n">tuto</span><span class="o">.</span><span class="n">main</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">mc.tuto.dao.ProduitsDao</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">mc.tuto.entities.Produits</span><span class="p">;</span>

    <span class="n">public</span> <span class="k">class</span> <span class="nc">Main</span> <span class="p">{</span>
        <span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>

            <span class="n">ProduitsDao</span> <span class="n">pdao</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ProduitsDao</span><span class="p">();</span>

            <span class="n">List</span><span class="o">&lt;</span><span class="n">Produits</span><span class="o">&gt;</span> <span class="n">produits</span> <span class="o">=</span> <span class="n">pdao</span><span class="o">.</span><span class="n">getAll</span><span class="p">();</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">Produits</span> <span class="n">p</span> <span class="p">:</span> <span class="n">produits</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">printf</span><span class="p">(</span><span class="s2">"[</span><span class="si">%d</span><span class="s2">] </span><span class="si">%s</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">getId</span><span class="p">(),</span> <span class="n">p</span><span class="o">.</span><span class="n">getNom</span><span class="p">());</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>


<p><img alt="new-project-hibernate-main" src="images/eclipse_create_project_17.png"/></p></section>
                      </div>
                    <div class="articleComments">
<!--                        <div class="note">-->
<!--                          <p class="note-title">Note</p>-->
<!--                          <p class="last">If you are using IronPython, use <code class="docutils literal"><span class="pre">IRONPYTHONPATH</span></code> instead of-->
<!--                          <code class="docutils literal"><span class="pre">PYTHONPATH</span></code>.</p>-->
<!--                        </div>-->
                    </div>
                  </div>
                  <footer>
                    <div id="id-current" style="display: none;"></div>
                    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
                      <a href="#" class="btn btn-neutral float-right" title="next" accesskey="n" rel="next"><span class="fa fa-arrow-circle-right"></span></a>
                      <a href="#" class="btn btn-neutral" title="previous" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span></a>
                    </div>
                    <hr>
                    <div role="contentinfo"><p><i class="far fa-copyright"></i> Copyright 2019, MC. </p></div>
                  </footer>
                </div>
      </section>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.bundle.min.js"></script>
    <script>
        $(function(){
          $(".toctree-l1>a").click(function(){
                var id = $(this).attr('href');
                $('.article').removeClass('active');
                $(id).addClass('active').fadeOut(0).fadeIn(1000);
          });
          $('blockquote>p').each(function(){
               if($(this).text().startsWith('Positive')){
                  $(this).parent().addClass( "special" );
                  $(this).text($(this).text().substring(8));
               }
               if($(this).text().startsWith('Negative')){
                  $(this).parent().addClass( "warning" );
                  $(this).text($(this).text().substring(8));
               }
          });
          $('#night-mode').click(function(e){
               e.preventDefault();

               if($('#night').length){
                     $('#night').remove();
                       $(this).html('<i class="fas fa-moon"></i>');
               }else{
                    $('head').append($('<link rel="stylesheet" id="night" type="text/css" />').attr('href', 'assets/css/night.mode.css'));
                    $(this).html('<i class="fas fa-sun"></i>');
               }
          });

          $('.navbar-nav-mob li').click(function(e){
                $('#navbarNavAltMarkup').removeClass('show');
          });


        });
    </script>

</body>
</html>
